<h1 class="mb-4 text-center">Products</h1>

<div class="row row-cols-1 row-cols-md-3 g-4">
  <% @products.each do |product| %>
    <% first_variant = product.product_variants.first %>
    <div class="col">
      <div class="card h-100 shadow-sm">
        <%= link_to url_for(controller: :pos, action: :show, id: product.id), class: "text-decoration-none text-dark" do %>
          <% if first_variant&.image&.attached? %>
            <%= image_tag first_variant.image.variant(resize_to_limit: [150, 150]), class: "card-img-top mx-auto d-block pt-3", alt: product.name, style: "width:150px; height:150px; object-fit: contain;" %>
          <% else %>
            <%= image_tag "https://via.placeholder.com/150?text=No+Image", class: "card-img-top mx-auto d-block pt-3", alt: "No image available", style: "width:150px; height:150px; object-fit: contain;" %>
          <% end %>
          <div class="card-body d-flex flex-column justify-content-between">
            <h5 class="card-title text-center"><%= product.name %></h5>
            <p class="card-text text-center text-primary fs-5 fw-bold">MMK <%= product.price %></p>
            <% if first_variant&.stock.to_i > 0 %>
              <span class="badge bg-success text-center d-block">In Stock</span>
            <% else %>
              <span class="badge bg-danger text-center d-block">Sold Out</span>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
